%mcm2019_bottlenecks2.m

for x=0:0.6:18
    plot([x,x],[0,18],'k');
    hold on
end
for y=0:0.6:18
    plot([0,36],[y,y],'k');
    hold on
end
xlim([0,18]);
ylim([0,18]);
fill([0,15,15,0],[0,0,15,15],'b');
for i=1:6
    for j=0:4
    fill([15-0.6*i,15-0.6*i+0.6,15-0.6*i+0.6,15-0.6*i],[15+0.6*j,15+0.6*j,15.6+0.6*j,15.6+0.6*j],'g');
    end
end
for x=15:0.6:17.4
   for y=15:0.6:17.4
       fill([x,x+0.6,x+0.6,x],[y,y,y+0.6,y+0.6],'g');
   end
end
for x=15:0.6:17.4
    for j=1:6
        fill([x,x+0.6,x+0.6,x],[15-0.6*j,15-0.6*j,15.6-0.6*j,15.6-0.6*j],'g');
    end
end

fill([15,18,18,18-1.8],[15,18-1.8,18,18],'y');
hold on
plot([15,18],[15,18],'r');
x1=15-1.8;y1=15;x2=15;y2=15-1.8;x3=15-0.6;y3=15-0.6;
m=det([1,x1,y1;
            1,x2,y2;
            1,x3,y3]);
        r = sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2))*sqrt((x2-x3)*(x2-x3)+(y2-y3)*(y2-y3))*sqrt((x1-x3)*(x1-x3)+(y1-y3)*(y1-y3))/abs(m)/2;
x=det([1,  x1^2+y1^2,  y1;
           1,  x2^2+y2^2,  y2;
           1,  x3^2+y3^2,  y3])/m/2;
        
y=det([1,  x1,  x1^2+y1^2;
           1,  x2,  x2^2+y2^2;
           1,  x3,  x3^2+y3^2])/m/2;
      
       f=ezplot('(x-14.65)^2+(y-14.65)^2=0.3565^2',[14.7,15],[14.7,15]);
        set(f,'Color','r','LineWidth',4);
       hold on
 h=ezplot('(x-12.9)^2+(y-12.9)^2=2.1213^2',[15-1.8,15],[15-1.8,15]);
 set(h,'Color','r','LineWidth',3);